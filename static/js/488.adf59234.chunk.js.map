{"version":3,"file":"static/js/488.adf59234.chunk.js","mappings":"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","sources":["components/GroupComponents/GroupHeader.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport { query, where, collection, getDocs } from \"firebase/firestore\"\r\nimport { db } from \"../../config/firebase\"\r\n\r\nimport SettingsIcon from \"../../images/settings.png\"\r\n\r\ninterface GroupHeaderProps {\r\n  groupTitle: string | null\r\n  originalGroupName?: string\r\n  newGroupName: string\r\n  groupId: string\r\n  onGroupNameChange: (e: React.ChangeEvent<HTMLInputElement>) => void\r\n  handleUpdateGroupName: () => void\r\n  onDeleteGroup: () => void\r\n}\r\n\r\nconst GroupHeader: React.FC<GroupHeaderProps> = ({\r\n  groupTitle,\r\n  originalGroupName,\r\n  newGroupName,\r\n  groupId,\r\n  onGroupNameChange,\r\n  handleUpdateGroupName,\r\n  onDeleteGroup,\r\n}) => {\r\n  const [isEditingGroupName, setIsEditingGroupName] = useState(false)\r\n  const [showMenu, setShowMenu] = useState(false)\r\n  const [activityLogs, setActivityLogs] = useState<any[]>([])\r\n  const [showActivityLogs, setShowActivityLogs] = useState(false)\r\n  const [currency, setCurrency] = useState<string>(\"\")\r\n\r\n  useEffect(() => {\r\n    const hash = window.location.hash\r\n    const currencyParamIndex = hash.indexOf(\"currency=\")\r\n\r\n    if (currencyParamIndex !== -1) {\r\n      const currencyParam = hash.slice(currencyParamIndex + \"currency=\".length)\r\n      setCurrency(decodeURIComponent(currencyParam))\r\n    }\r\n  }, [])\r\n\r\n  const fetchActivityLogs = async () => {\r\n    try {\r\n      if (!groupId) {\r\n        console.error(\"groupId is undefined\")\r\n        return\r\n      }\r\n\r\n      const activityLogsCollectionRef = collection(db, \"activityLogs\")\r\n      const logsQuery = query(\r\n        activityLogsCollectionRef,\r\n        where(\"groupId\", \"==\", groupId)\r\n      )\r\n      const querySnapshot = await getDocs(logsQuery)\r\n      const logsData = querySnapshot.docs.map((doc) => doc.data())\r\n      logsData.sort((a, b) => b.timestamp.seconds - a.timestamp.seconds)\r\n      setActivityLogs(logsData)\r\n    } catch (error) {\r\n      console.error(\"Error fetching activity logs:\", error)\r\n    }\r\n  }\r\n\r\n  const toggleActivityLogs = async () => {\r\n    if (!showActivityLogs) {\r\n      document.body.classList.add(\"no-scroll\")\r\n      await fetchActivityLogs()\r\n    } else {\r\n      document.body.classList.remove(\"no-scroll\")\r\n    }\r\n    setShowActivityLogs(!showActivityLogs)\r\n    setShowMenu(false)\r\n  }\r\n\r\n  const toggleMenu = () => {\r\n    setShowMenu(!showMenu)\r\n  }\r\n\r\n  const cancelEdit = () => {\r\n    setIsEditingGroupName(false)\r\n  }\r\n\r\n  const stopPropagation = (e: React.MouseEvent) => {\r\n    e.stopPropagation()\r\n  }\r\n\r\n  const renderLogMessage = (log) => {\r\n    const convertTimestampToDateTime = (timestamp) => {\r\n      const date = new Date(\r\n        timestamp.seconds * 1000 + timestamp.nanoseconds / 1000000\r\n      )\r\n      return date.toLocaleString()\r\n    }\r\n    const dateTimeAdded = convertTimestampToDateTime(log.timestamp)\r\n\r\n    switch (log.action) {\r\n      case \"MemberAdded\":\r\n        return `The user with email \"${log.addedBy}\" added a member called \"${log.memberName}\" at ${dateTimeAdded}.`\r\n      case \"MemberDeleted\":\r\n        return `The user with email \"${log.deletedBy}\" deleted a member called \"${log.memberName}\" at ${dateTimeAdded}.`\r\n\r\n      case \"ExpenseAdded\":\r\n        return `The user with email \"${log.addedBy}\" added an expense of ${log.amount} ${currency} at ${dateTimeAdded}.`\r\n\r\n      case \"ExpenseDeleted\":\r\n        return `The user with email \"${log.deletedBy}\" deleted an expense of ${log.amount} ${currency} at ${dateTimeAdded}.`\r\n      default:\r\n        return \"Unknown log action\"\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"top-delete-button\">\r\n        <h1 data-testid=\"group-name-title\" className=\"group-title\">\r\n          {groupTitle || \"Group Name\"}\r\n        </h1>\r\n\r\n        {showActivityLogs && (\r\n          <div className=\"modal-activity-log\">\r\n            <div className=\"modal-activity-log-main\">\r\n              <button\r\n                style={{ position: \"absolute\", right: \"5px\", top: \"-10px\" }}\r\n                onClick={toggleActivityLogs}\r\n              >\r\n                X\r\n              </button>\r\n\r\n              {activityLogs.length > 0 ? (\r\n                <h3>Activity Logs for {groupTitle}</h3>\r\n              ) : (\r\n                <h3>No activity recorded yet.</h3>\r\n              )}\r\n              <ul>\r\n                {activityLogs.map((log, index) => (\r\n                  <div key={index}>\r\n                    <li>{renderLogMessage(log)}</li>\r\n                    <br />\r\n                  </div>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div className=\"menu-icon\" onClick={toggleMenu}>\r\n          <img\r\n            width={30}\r\n            height={30}\r\n            src={SettingsIcon}\r\n            alt=\"Settings Icon\"\r\n            style={{\r\n              cursor: \"pointer\",\r\n              transition: \"transform 0.3s ease-in-out\",\r\n              transform: showMenu ? \"rotate(90deg)\" : \"rotate(0deg)\",\r\n            }}\r\n          />\r\n          {showMenu && (\r\n            <div className=\"menu-dropdown\" onClick={stopPropagation}>\r\n              <p>Squad ID: {groupId}</p>\r\n              <button onClick={toggleActivityLogs}>Show Activity Logs</button>\r\n\r\n              {isEditingGroupName ? (\r\n                <>\r\n                  <h2 style={{ marginInline: \"0.2rem\" }}>Edit Squad Name</h2>\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Enter New Group Name\"\r\n                    data-testid=\"group-name-input\"\r\n                    value={\r\n                      isEditingGroupName ? newGroupName : originalGroupName\r\n                    }\r\n                    onChange={onGroupNameChange}\r\n                    maxLength={20}\r\n                    style={{ width: \"unset\", marginInline: \"0.3rem\" }}\r\n                  />\r\n                  <button\r\n                    onClick={() => {\r\n                      handleUpdateGroupName()\r\n                      setShowMenu(false)\r\n                      setIsEditingGroupName(false)\r\n                    }}\r\n                    disabled={newGroupName.trim() === \"\"}\r\n                  >\r\n                    Update Squad Name\r\n                  </button>\r\n                  <button onClick={cancelEdit}>Cancel</button>\r\n                </>\r\n              ) : (\r\n                <button onClick={() => setIsEditingGroupName(true)}>\r\n                  Edit Squad Name\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={onDeleteGroup}\r\n                style={{ backgroundColor: \"#ff0000bd\", color: \"#ffffffed\" }}\r\n              >\r\n                Delete Squad\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default GroupHeader\r\n"],"names":["_ref","groupTitle","originalGroupName","newGroupName","groupId","onGroupNameChange","handleUpdateGroupName","onDeleteGroup","_useState","useState","_useState2","_slicedToArray","isEditingGroupName","setIsEditingGroupName","_useState3","_useState4","showMenu","setShowMenu","_useState5","_useState6","activityLogs","setActivityLogs","_useState7","_useState8","showActivityLogs","setShowActivityLogs","_useState9","_useState10","currency","setCurrency","useEffect","hash","window","location","currencyParamIndex","indexOf","currencyParam","slice","decodeURIComponent","fetchActivityLogs","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","activityLogsCollectionRef","logsQuery","querySnapshot","logsData","wrap","_context","prev","next","console","error","abrupt","collection","db","query","where","getDocs","sent","docs","map","doc","data","sort","a","b","timestamp","seconds","t0","stop","apply","arguments","toggleActivityLogs","_ref3","_callee2","_context2","document","body","classList","add","remove","renderLogMessage","log","dateTimeAdded","Date","nanoseconds","toLocaleString","action","concat","addedBy","memberName","deletedBy","amount","_jsx","children","_jsxs","className","style","position","right","top","onClick","length","index","width","height","src","SettingsIcon","alt","cursor","transition","transform","e","stopPropagation","_Fragment","marginInline","type","placeholder","value","onChange","maxLength","disabled","trim","backgroundColor","color"],"sourceRoot":""}